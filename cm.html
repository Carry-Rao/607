<!DOCTYPE html>
<html>
<head>
	<title>同学</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="shortcut icon" href="icon.ico" type="image/x-icon">
    <style>
        table {
            color: white;
        }
    </style>
</head>
<body>
    <div id="navbar">
        <div class="nbb" onclick="window.location.href='/index.html'">首页</div>
        <div class="nbb" onclick="window.location.href='/news.html'">资源</div>
        <div class="nbb" onclick="window.location.href='/cm.html'">同学</div>
        <div class="nbb" onclick="window.location.href='/memory.html'">回忆</div>
    </div>
    <table border="1">
        <thead>
            <td>
                <th>微信号</th>
                <th>手机号</th>
                <th>邮箱</th>
                <th>QQ号</th>
            </td>
        </thead>
        <tbody id="container">
            
        </tbody>
    </table>
</body>
<script>
    function getCookie(name) {
        var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
        if (arr = document.cookie.match(reg))
            return unescape(arr[2]);
        else
            return null;
    }
    function strlen (str) {

    }
    var username = getCookie("username");
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "https://607bg.carryrao.top/cm", true);
    xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
        if (xhr.status == 200) {
            var result = JSON.parse(xhr.responseText);
            if (result.status == "success") {
                // 检查 result.data 是否为 null 或 undefined
                if (!result.data) {
                    console.error("result.data is null or undefined:", result.data);
                    return;
                }
                // 解析数据
                var container = document.getElementById("container");
                for (var i = 0; i < result.data.length; i++) {
                    var tr = document.createElement("tr");
                    var td1 = document.createElement("td");
                    var td2 = document.createElement("td");
                    var td3 = document.createElement("td");
                    var td4 = document.createElement("td");
                    var td5 = document.createElement("td");
                    td1.innerHTML = result.data[i].name;
                    td2.innerHTML = result.data[i].wechat;
                    td3.innerHTML = result.data[i].phone;
                    td4.innerHTML = result.data[i].email;
                    td5.innerHTML = result.data[i].qq;
                    tr.appendChild(td1);
                    tr.appendChild(td2);
                    tr.appendChild(td3);
                    tr.appendChild(td4);
                    tr.appendChild(td5);
                    container.appendChild(tr);
                }
            } else {
                console.error("Request was successful, but status was not 'success':", result.status);
            }
        } else if (xhr.status == 530) {
            console.error("Server responded with status code 530");
        } else {
            console.error("Request failed with status code:", xhr.status);
        }
    }
};

    xhr.send("username=" + encodeURIComponent(username));
        
</script>
</html>
